<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>QA Hierarchy</title>

  <!-- Local OrgChart library (self-hosted) -->
  <script src="./orgchart.js"></script>

  <style>
    body {
      margin: 0;
      background: #0b2233;
      font-family: Arial, sans-serif;
    }
    #tree {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>

<body>
  <div id="tree"></div>

  <script>
    const DATA_URL = "https://script.google.com/macros/s/AKfycbygw8c5ss2yW5wneBny74TUhD9_aRQIEQWZ03UaPfUyyX2J2m0cj9P7ydPbs2fXW53r/exec";

    fetch(DATA_URL)
      .then(res => res.json())
      .then(data => {

        // Fix root node + types
        data.forEach(n => {
          if (n.pid === "" || n.pid === null) delete n.pid;
          n.id = String(n.id);
          if (n.pid !== undefined) n.pid = String(n.pid);
        });

        new OrgChart(document.getElementById("tree"), {
          template: "olivia",
          enableSearch: true,
          mouseScrool: OrgChart.action.zoom,
          nodeBinding: {
            field_0: "name",
            field_1: "title"
          },
          nodes: data
        });
      })
      .catch(err => console.error(err));
  </script>
</body>
</html>
